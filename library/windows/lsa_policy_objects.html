
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LSA Policy Objects &#8212; Threat Hunter Playbook</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >let toggleHintShow = 'Click to show';</script>
    <script >let toggleHintHide = 'Click to hide';</script>
    <script >let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://threathunterplaybook.com/library/windows/lsa_policy_objects.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Mimikatz OpenProcess Modules" href="mimikatz_openprocess_modules.html" />
    <link rel="prev" title="Logon Session" href="logon_session.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Threat Hunter Playbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Knowledge Library
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Windows
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="active_directory_replication.html">
     Active Directory Replication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adfs_dkm_keys.html">
     Active Directory Federation Services (ADFS) Distributed Key Manager (DKM) Keys
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="data_protection_api.html">
     Data Protection API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="logon_session.html">
     Logon Session
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     LSA Policy Objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mimikatz_openprocess_modules.html">
     Mimikatz OpenProcess Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="process_access_rights.html">
     Process Security and Access Rights
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="security_account_manager_database.html">
     Security Account Manager (SAM) Database
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="security_account_manager_protocol.html">
     Security Account Manager Remote Protocol (SAMRP)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="security_assertion_markup_language.html">
     Security Assertion Markup Language (SAML)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="service_control_manager.html">
     Service Control Manager
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="syskey.html">
     SysKey
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="task_scheduler_service.html">
     Task Scheduler Service
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pre-Hunt Activities
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pre-hunt/data_management.html">
   Data Management
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pre-hunt/data_documentation.html">
     Data Documentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pre-hunt/data_standardization.html">
     Data Standardization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pre-hunt/data_modeling.html">
     Data Modeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pre-hunt/data_quality.html">
     Data Quality
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Campaign Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../evals/intro.html">
   ATT&amp;CK Evaluations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../evals/apt29/intro.html">
     APT 29
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../evals/apt29/report.html">
       Free Telemetry Report
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/campaigns/apt29Evals.html">
       Free Telemetry Notebook
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Targeted Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../notebooks/windows/intro.html">
   Windows
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/02_execution/intro.html">
     Execution
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190410151110.html">
       Basic PowerShell Execution
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190511223310.html">
       PowerShell Remote Session
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190610201010.html">
       Alternate PowerShell Hosts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190810201010.html">
       WMI Win32_Process Class and Create Method for Remote Execution
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190811201010.html">
       WMI Module Load
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190813181020.html">
       Service Creation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-190815181010.html">
       Remote Service creation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/02_execution/WIN-201009173318.html">
       Remote WMI Wbemcomn DLL Hijack
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/03_persistence/intro.html">
     Persistence
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/03_persistence/WIN-190810170510.html">
       WMI Eventing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/03_persistence/WIN-200902020333.html">
       Remote WMI ActiveScriptEventConsumers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/04_privilege_escalation/intro.html">
     Privilege Escalation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/04_privilege_escalation/WIN-200902020333.html">
       Remote WMI ActiveScriptEventConsumers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/intro.html">
     Defense Evasion
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/WIN-180719170510.html">
       DLL Injection via CreateRemoteThread and LoadLibrary
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/WIN-190101151110.html">
       Active Directory Replication User Backdoor
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/WIN-190407183310.html">
       Enable Remote Desktop Conections Registry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/WIN-190510202010.html">
       WDigest Downgrade
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/WIN-191224222300.html">
       Extended NetNTLM Downgrade
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/05_defense_evasion/WIN-201012183248.html">
       Wuauclt CreateRemoteThread Execution
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/06_credential_access/intro.html">
     Credential Access
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/06_credential_access/WIN-170105221010.html">
       LSASS Access from Non System Account
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/06_credential_access/WIN-180815210510.html">
       Active Directory Replication From Non-Domain-Controller Accounts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/06_credential_access/WIN-190620024610.html">
       Domain DPAPI Backup Key Extraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/06_credential_access/WIN-190725024610.html">
       SAM Registry Hive Handle Request
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/06_credential_access/WIN-191030201010.html">
       Remote Interactive Task Manager LSASS Dump
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/07_discovery/intro.html">
     Discovery
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/07_discovery/WIN-190625024610.html">
       SysKey Registry Keys Access
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/07_discovery/WIN-190725024610.html">
       SAM Registry Hive Handle Request
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/07_discovery/WIN-190826010110.html">
       Remote Service Control Manager Handle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/intro.html">
     Lateral Movement
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-190511223310.html">
       PowerShell Remote Session
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-190810201010.html">
       WMI Win32_Process Class and Create Method for Remote Execution
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-190815181010.html">
       Remote Service creation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-200902020333.html">
       Remote WMI ActiveScriptEventConsumers
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-201009173318.html">
       Remote WMI Wbemcomn DLL Hijack
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-201009183000.html">
       Remote DCOM IErtUtil DLL Hijack
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/08_lateral_movement/WIN-201012004336.html">
       SMB Create Remote File
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../notebooks/windows/09_collection/intro.html">
     Collection
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../notebooks/windows/09_collection/WIN-200609225055.html">
       Access to Microphone Device
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/jupyter/introduction.html">
   Jupyter Notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/jupyter/installing_jupyter.html">
     Jupyter Server Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/jupyter/notebooks/01_intro_to_python.html">
     Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/jupyter/notebooks/02_intro_to_numpy_arrays.html">
     Introduction to Python NumPy Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/jupyter/notebooks/03_intro_to_pandas.html">
     Introduction to Pandas
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/library/windows/lsa_policy_objects.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OTRF/ThreatHunter-Playbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OTRF/ThreatHunter-Playbook/issues/new?title=Issue%20on%20page%20%2Flibrary/windows/lsa_policy_objects.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/OTRF/ThreatHunter-Playbook/edit/master/docs/library/windows/lsa_policy_objects.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#policy-object">
   Policy Object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trusteddomain-object">
   TrustedDomain Object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#account-object">
   Account Object
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#private-data-object">
     Private Data Object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-private-data-objects-l">
     Local private data objects (L$)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#global-private-data-objects-g">
     Global private data objects (G$)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#machine-private-data-objects-m">
     Machine private data objects (M$)
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>LSA Policy Objects</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#policy-object">
   Policy Object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trusteddomain-object">
   TrustedDomain Object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#account-object">
   Account Object
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#private-data-object">
     Private Data Object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-private-data-objects-l">
     Local private data objects (L$)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#global-private-data-objects-g">
     Global private data objects (G$)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#machine-private-data-objects-m">
     Machine private data objects (M$)
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="lsa-policy-objects">
<h1>LSA Policy Objects<a class="headerlink" href="#lsa-policy-objects" title="Permalink to this headline">¶</a></h1>
<p>The LSA stores local security policy information in a set of objects. Your application can query or edit the local security policy by accessing these objects.</p>
<p>The set consists of the following four objects:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Policy</span></code> contains global policy information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TrustedDomain</span></code> contains information about a trusted domain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Account</span></code> contains information about a user, group, or local group account.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Private</span> <span class="pre">Data</span></code> contains protected information, such as server account passwords. This information is stored as encrypted strings.</p></li>
</ul>
<div class="section" id="policy-object">
<h2>Policy Object<a class="headerlink" href="#policy-object" title="Permalink to this headline">¶</a></h2>
<p>The Policy object is used to control access to the Local Security Authority (LSA) database and contains information that applies to the entire system or establishes defaults for the system. Each system has only one Policy object. This Policy object is created by the LSA when the system starts up, and applications cannot create or destroy it.</p>
</div>
<div class="section" id="trusteddomain-object">
<h2>TrustedDomain Object<a class="headerlink" href="#trusteddomain-object" title="Permalink to this headline">¶</a></h2>
<p>The TrustedDomain object stores information about a trust relationship with a domain. A TrustedDomain object is created on the trusting system to identify an account within the trusted domain that can be used to submit authentication requests and to perform other operations, such as name and security identifier (SID) translations.</p>
</div>
<div class="section" id="account-object">
<h2>Account Object<a class="headerlink" href="#account-object" title="Permalink to this headline">¶</a></h2>
<p>The Account object is used to assign privileges, system access, and special quotas to individual users or to members of local groups or groups.</p>
<div class="section" id="private-data-object">
<h3>Private Data Object<a class="headerlink" href="#private-data-object" title="Permalink to this headline">¶</a></h3>
<p>A limited number of private data objects are available on each system for the purpose of storing information in a protected, encrypted, fashion.</p>
<p>Private data objects are provided primarily to support storage of server account passwords. This is useful for servers that run in a specific account. The password of the server account is private data that should be secured but is needed to log the server on.</p>
<p>Private data objects may be general purpose, or they may be one of three specialized types: local, global, and machine.</p>
</div>
<div class="section" id="local-private-data-objects-l">
<h3>Local private data objects (L$)<a class="headerlink" href="#local-private-data-objects-l" title="Permalink to this headline">¶</a></h3>
<p>They can only be read locally from the computer storing the object. Attempting to read them remotely results in a STATUS_ACCESS_DENIED error. Local private data objects have key names that begin with the prefix “L<span class="math notranslate nohighlight">\(&quot;. In addition to the local private objects you create, the operating system defines the following local private objects: \)</span>machine.acc, SAC, SAI, and SANSC.</p>
</div>
<div class="section" id="global-private-data-objects-g">
<h3>Global private data objects (G$)<a class="headerlink" href="#global-private-data-objects-g" title="Permalink to this headline">¶</a></h3>
<p>They are global in the sense that if they are created on a domain controller, they will be automatically replicated to all domain controllers in that domain. In other words, each domain controller in that domain will have access to the values the global private data object contains. In contrast, global private data objects created on a system that is not a domain controller, as well as nonglobal private data objects, are not replicated. Global private data objects have key names beginning with “G$”.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G$BCKUPKEY_PREFERRED</span></code> LSA secret: It contains key pair identifier (16-byte GUID) of object that holds the current modern key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">G$BCKUPKEY_P</span></code> LSA secret: It contains GUID of object that holds the legacy key</p></li>
</ul>
</div>
<div class="section" id="machine-private-data-objects-m">
<h3>Machine private data objects (M$)<a class="headerlink" href="#machine-private-data-objects-m" title="Permalink to this headline">¶</a></h3>
<p>They can be accessed only by the operating system. These objects have key names that begin with “M$”.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "OTRF/ThreatHunter-Playbook",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./library\windows"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="logon_session.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Logon Session</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="mimikatz_openprocess_modules.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mimikatz OpenProcess Modules</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Roberto Rodriguez @Cyb3rWard0g<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  
  </body>
</html>